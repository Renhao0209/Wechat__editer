# Changelog

本项目的变更记录。格式参考 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.1.0/)，版本号遵循 [SemVer](https://semver.org/lang/zh-CN/)。

## [Unreleased]

### Added

- Nightly Windows 安装包自动发布：推送到 `main` 自动打包并更新 `nightly-win` Release。

### Changed

- Windows 发布工作流拆分：Tag 发布走正式 Release；旧的发布脚本保留为手动触发。

### Fixed

- 公众号发布后正文“重叠/挤在一起”：内联导出不再依赖后台自动段落间距。
- 公众号发布后图片/部分组件前后出现大量空白：压缩空段落（仅含 `<br>` / `&nbsp;`）的样式，避免空白被放大。

### Removed

- 

## [0.3.0] - 2026-02-04

### Added

- 编辑区右键菜单：富文本/Markdown 通用常用操作。
- 段落级首行缩进：仅作用于光标所在段落，并贯通编辑态/导出/复制内联。
- 段落级对齐：仅作用于光标所在段落，并贯通编辑态/导出/复制内联。
- 工具栏「格式刷」：单击单次；双击锁定连续刷（Esc 退出）。
- Windows 打包“铁律”：clean → 版本号更新 → 更新 CHANGELOG → 生成 release-notes → 打包。
- `dist:win:watch`：保存代码自动触发 `dist:win`。

### Changed

- 工具栏格式高亮：改为随选区/事务同步，保证选中任意内容都能正确高亮。

### Fixed

- 右键菜单：自适应宽高并贴边，避免超出屏幕。
- 内联复制/导出：段落级缩进与对齐样式保持一致。

## [0.2.5] - 2026-02-04

### Changed

- 例行构建（未填写 Unreleased 变更条目）。

## [0.2.4] - 2026-02-04

### Changed

- 例行构建（未填写 Unreleased 变更条目）。

## [0.2.3] - 2026-02-04

### Changed

- 例行构建（未填写 Unreleased 变更条目）。

## [0.2.2] - 2026-01-29

### Added

- 组件 props 迁移框架：支持在 props 内写入 `_v`（版本号），并按组件 `schemaVersion` 自动顺序迁移（见 `COMPONENT_MIGRATIONS` registry）。
- propSchema 字段类型扩展：新增 `number` / `range` / `switch`，并支持 `min/max/step` 与 `visibleWhen/disabledWhen` 条件元数据。
- 通用弹窗壳组件：新增可复用的 `Modal`，支持按 `Esc` 关闭、点击遮罩关闭。

### Changed

- 真实迁移示例：`calloutInfo` 组件 schemaVersion 升级到 2，并将字段 `variant` 重命名为 `kind`（旧文档自动迁移）。
- 组件链路统一走 normalize：插入/选中/应用属性/复制样式等路径统一先做 props normalize（含迁移）再渲染输出。
- 代码结构瘦身：将 WeChatEditor 中的“属性面板 / 素材库 Dock / 组件选中解析 / Spec 与 props helpers / 多个弹窗”逐步抽离为独立模块与组件。

### Fixed

- 默认参数持久化：保存“用户默认参数”时自动剔除内部字段（如 `_v`），避免污染用户配置。

## [0.2.1] - 2026-01-28

### Fixed

- 公众号粘贴兼容性：复制时强制写入 `text/html`，避免剪贴板退化成纯文本导致样式丢失。
- 公众号粘贴观感：新增“全量内联（计算样式）”复制策略，更接近预览效果。
- 伪元素兼容：将 `h2.section::before` 的竖条标记转换为真实 `border-left`，避免粘贴后丢失。
- 顶部裁切缓解：增加更稳的顶部空行与间距处理，减少首块内容被裁切的概率。

## [0.2.0] - 2026-01-28

### Added

- 文件资源管理器（桌面版）：支持选择根目录、目录树展开、搜索与类型筛选。
- 资源管理器操作：右键菜单、拖拽移动、内联新建/重命名（F2）、删除（含文件夹递归删除）。
- 文字颜色：富文本/Markdown 均支持任意颜色、清除颜色、常用色板与最近颜色。
- 组件体系：属性面板、组件参数持久化（`data-wce-*` / `wceProps`），并支持重置默认/复制样式到同类。
- 组件库列表：卡片化展示（标签/描述/占位缩略图/增强搜索）。
- 图片样式：新增多种图片外观（圆角/阴影/描边/圆形），可在工具栏一键套用。

### Fixed

- 修复组件块在编辑器内难以选中、属性面板无法读取的问题：点击组件任意区域会选中整个组件块。
- Markdown 模式：保留组件块 HTML，支持源码光标定位并编辑组件参数（覆盖更多标签类型）。
- 容器类组件：应用属性时不再覆盖组件内部正文内容（例如“紫金边框 + 内嵌滚动区”）。

## [0.1.3] - 2026-01-28

### Added

- 桌面版：更多菜单新增「检查更新」，支持从 GitHub Releases 检查/下载/安装更新。

### Changed

- Windows 安装包命名调整为「WeChat Editor-<版本号>.exe」。

### Fixed

- 修复「更多」下拉菜单在横向滚动容器内可能被裁剪的问题。

## [0.1.2] - 2026-01-28

### Added

- 顶栏菜单：新增应用内菜单（文件/编辑/视图/帮助），支持点击外部与 Esc 自动收起。

### Changed

- 顶栏布局：左侧内容分组优化（主区/次区），窄窗口下换行更紧凑；快捷操作整体并入左侧。
- 菜单交互：各菜单互斥打开，点击菜单项后自动收起。

### Fixed

- 修复「更多」下拉在窄宽/横向滚动容器下被裁剪导致无法弹出的情况。

## [0.1.1] - 2026-01-28

### Added

- 新增桌面版（Windows）打包与发布：支持生成 NSIS 安装包，并可通过 GitHub Releases 分发。

### Changed

- 应用信息：桌面版显示名调整为「微信排版助手」，并同步设置应用/安装包图标。

## [0.1.0] - 2026-01-28

### Added

- 新增编辑格式切换：支持“富文本 / Markdown 源码”模式，Markdown 可实时渲染到预览并可切回富文本覆盖写入。

### Changed

- UI 交互：编辑区与预览区支持双向滚动同步，并修复同步导致的“自动回滚/抖动”。
- 滚动条样式：编辑区/预览/素材库滚动条改为更接近 macOS 的半透明浮层风格；同时避免外层页面出现多余滚动条。

### Fixed

- 组件「可滚动框/活动公告」内部滚动条隐藏（保留可滚动），预览/导出与编辑器内表现一致。
